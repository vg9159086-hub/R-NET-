<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>R-Net Artists</title>

<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>

<style>
body{
    font-family: Arial;
    background:#111;
    color:white;
    text-align:center;
    margin:0;
}

header{
    background:black;
    padding:20px;
    font-size:28px;
    font-weight:bold;
    color:gold;
}

#warning{
    background:#222;
    padding:12px;
    font-size:15px;
}

#loginArea{
    margin:25px;
}

input, button{
    padding:10px;
    margin:6px;
    border-radius:6px;
    border:none;
}

button{
    background:gold;
    font-weight:bold;
    cursor:pointer;
}

#adminPanel{
    display:none;
    margin:20px;
    background:#222;
    padding:20px;
    border-radius:10px;
}

#artists{
    display:flex;
    flex-wrap:wrap;
    justify-content:center;
    gap:20px;
    padding:20px;
}

.card{
    background:#1a1a1a;
    border:3px solid gold;
    border-radius:15px;
    width:260px;
    padding:15px;
}

.card img{
    width:100%;
    height:auto;
    border-radius:10px;
}

.name{
    font-size:20px;
    font-weight:bold;
    margin-top:10px;
}

.info{
    font-size:14px;
    margin:3px 0;
}

.reactions{
    margin-top:10px;
}

.reactions img{
    width:28px;
    cursor:pointer;
    margin:5px;
}

.deleteBtn{
    background:red;
    color:white;
    margin-top:10px;
}
</style>
</head>
<body>

<header>R-Net Artists</header>

<div id="warning">
Aprecie todos os grupos aqui
</div>

<div id="loginArea">
<input id="empresaNome" placeholder="Nome da empresa"><br>
<input id="empresaSenha" type="password" placeholder="Senha"><br>
<button onclick="enterAdmin()">Entrar como Empresa</button>
<button onclick="enterVisitor()">Entrar como Visitante</button>
</div>

<div id="adminPanel">
<h3>Cadastrar Artista</h3>
<input id="name" placeholder="Nome"><br>
<input id="type" placeholder="Grupo ou Solista"><br>
<input id="company" placeholder="Empresa"><br>
<input id="debut" placeholder="Ano de debut"><br>
<input id="debutSong" placeholder="Música de debut"><br>
<input id="tiktok" placeholder="@tiktok"><br>
<input id="image" placeholder="URL da imagem"><br>
<button onclick="addArtist()">Cadastrar</button>
</div>

<div id="artists"></div>

<script>
// ================= FIREBASE =================
const firebaseConfig = {
  apiKey: "AIzaSyAtv9gmTCvlor0zkdLzqWQbheeahr2xy9U",
authDomain: "rnet-artist.firebaseapp.com",
projectId: "rnet-artist",
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// ============ LOGIN EMPRESA ============
// Você pode mudar esses dados
const EMPRESA_NOME = "RNET";
const EMPRESA_SENHA = "1234";

let currentUser = "visitor";

// ================= LOGIN =================
function enterAdmin(){
    const nome = document.getElementById("empresaNome").value;
    const senha = document.getElementById("empresaSenha").value;

    if(nome === EMPRESA_NOME && senha === EMPRESA_SENHA){
        currentUser = nome;
        document.getElementById("adminPanel").style.display="block";
        document.getElementById("loginArea").style.display="none";
        loadArtists();
        confetti();
    }else{
        alert("Nome ou senha incorretos");
    }
}

function enterVisitor(){
    currentUser = "visitor";
    document.getElementById("loginArea").style.display="none";
    loadArtists();
    confetti();
}

// ================= CADASTRAR =================
function addArtist(){
    db.collection("artist").add({
        name: name.value,
        type: type.value,
        company: company.value,
        debut: debut.value,
        debutSong: debutSong.value,
        tiktok: tiktok.value,
        image: image.value,
        likes: 0,
        dislikes: 0,
        owner: currentUser,
        createdAt: new Date()
    });
}

// ================= LISTAR =================
function loadArtists(){
    db.collection("artist")
    .orderBy("createdAt","desc")
    .onSnapshot(snapshot=>{
        artists.innerHTML="";

        snapshot.forEach(doc=>{
            const a = doc.data();

            let deleteButton = "";
            if(currentUser !== "visitor" && currentUser === a.owner){
                deleteButton = `<button class="deleteBtn" onclick="deleteArtist('${doc.id}')">Excluir</button>`;
            }

            artists.innerHTML += `
            <div class="card">
                <img src="${a.image}">
                <div class="name">${a.name}</div>
                <div class="info">${a.type}</div>
                <div class="info">${a.company}</div>
                <div class="info">Debut: ${a.debut}</div>
                <div class="info">Song: ${a.debutSong}</div>
                <div class="info">${a.tiktok}</div>

                <div class="reactions">
                    <img src="like.png" onclick="like('${doc.id}', ${a.likes || 0})"> ${a.likes || 0}
                    <img src="deslike.png" onclick="dislike('${doc.id}', ${a.dislikes || 0})"> ${a.dislikes || 0}
                </div>

                ${deleteButton}
            </div>
            `;
        });
    });
}

// ================= EXCLUIR =================
function deleteArtist(id){
    db.collection("artist").doc(id).delete();
}

// ================= LIKE =================
function like(id, current){
    db.collection("artist").doc(id).update({
        likes: current + 1
    });
}

function dislike(id, current){
    db.collection("artist").doc(id).update({
        dislikes: current + 1
    });
}

// ================= CONFETE =================
function confetti(){
    for(let i=0;i<80;i++){
        const c = document.createElement("div");
        c.style.position="fixed";
        c.style.width="6px";
        c.style.height="6px";
        c.style.background="gold";
        c.style.left=Math.random()*100+"%";
        c.style.top="-10px";
        c.style.opacity="0.8";
        c.style.zIndex="999";
        document.body.appendChild(c);

        let fall = setInterval(()=>{
            let top = parseInt(c.style.top);
            c.style.top = top + 4 + "px";
            if(top > window.innerHeight){
                clearInterval(fall);
                c.remove();
            }
        },20);
    }
}
</script>

</body>
</html>
