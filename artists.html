<!DOCTYPE html><html>
<head>
<meta charset="UTF-8">
<title>R-Net Artists</title><script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script><script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script><style>
body{
    background:#111;
    color:white;
    font-family:Arial;
    text-align:center;
    margin:0;
}

button{
    padding:8px 15px;
    margin:5px;
    cursor:pointer;
}

input{
    padding:8px;
    margin:5px;
    width:200px;
}

.section{
    margin:20px;
}

.artistCard{
    border:4px solid gold;
    border-radius:12px;
    padding:15px;
    margin:20px auto;
    max-width:350px;
    background:#1c1c1c;
}

.artistCard img{
    width:100%;
    height:auto;
    object-fit:contain;
    background:black;
}

.hidden{
    display:none;
}
</style></head>
<body><h1>R-Net Artists</h1>
<p><b>Aprecie todos os grupos aqui!</b></p><!-- ESCOLHA INICIAL --><div id="home" class="section">
    <button onclick="entrarVisitante()">Entrar como Visitante</button>
    <button onclick="abrirEmpresa()">√Årea da Empresa</button>
</div><!-- AREA EMPRESA --><div id="empresaArea" class="section hidden"><h3>Login Empresa</h3>
<input id="loginNome" placeholder="Nome da empresa">
<input id="loginSenha" type="password" placeholder="Senha">
<button onclick="loginEmpresa()">Entrar</button>

<h3>Cadastrar nova Empresa</h3>
<input id="cadNome" placeholder="Nome">
<input id="cadSenha" type="password" placeholder="Senha">
<button onclick="cadastrarEmpresa()">Cadastrar</button>

<hr>

<div id="painelEmpresa" class="hidden">
    <h2>Cadastrar Artista</h2>

    <input id="artNome" placeholder="Nome do artista"><br>
    <input id="artTipo" placeholder="Grupo ou Solista"><br>
    <input id="artEmpresa" placeholder="Empresa"><br>
    <input id="artDebutMusica" placeholder="M√∫sica de Debut"><br>
    <input id="artDebutAno" placeholder="Ano de Debut"><br>
    <input id="artTiktok" placeholder="@TikTok"><br>
    <input id="artImagem" placeholder="URL da imagem (Google Drive)"><br>

    <button onclick="cadastrarArtista()">Publicar</button>
</div>

</div><h2>Artistas</h2>
<div id="artists"></div><script>
// FIREBASE
firebase.initializeApp({
  apiKey: "AIzaSyAtv9gmTCvlor0zkdLzqWQbheeahr2xy9U",
  authDomain: "rnet-artist.firebaseapp.com",
  projectId: "rnet-artist"
});

const db = firebase.firestore();
let empresaLogada = null;

// ======== NAVEGA√á√ÉO ========
function entrarVisitante(){
    document.getElementById("home").style.display="none";
    carregarArtistas();
}

function abrirEmpresa(){
    document.getElementById("home").style.display="none";
    document.getElementById("empresaArea").classList.remove("hidden");
}

// ======== CADASTRO EMPRESA ========
function cadastrarEmpresa(){
    const nome = cadNome.value.trim();
    const senha = cadSenha.value.trim();

    if(!nome || !senha){
        alert("Preencha tudo");
        return;
    }

    db.collection("companies").doc(nome).set({
        senha: senha
    }).then(()=> alert("Empresa cadastrada!"));
}

// ======== LOGIN ========
function loginEmpresa(){
    const nome = loginNome.value.trim();
    const senha = loginSenha.value.trim();

    db.collection("companies").doc(nome).get().then(doc=>{
        if(doc.exists && doc.data().senha === senha){
            empresaLogada = nome;
            document.getElementById("painelEmpresa").classList.remove("hidden");
            alert("Login realizado!");
        }else{
            alert("Empresa ou senha incorreta");
        }
    });
}

// ======== CONVERTER LINK GOOGLE DRIVE ========
function converterDrive(url){
    if(url.includes("drive.google.com")){
        const id = url.split("/d/")[1]?.split("/")[0];
        return "https://drive.google.com/uc?export=view&id=" + id;
    }
    return url;
}

// ======== CADASTRAR ARTISTA ========
function cadastrarArtista(){
    if(!empresaLogada){
        alert("Fa√ßa login como empresa");
        return;
    }

    const data = {
        nome: artNome.value.trim(),
        tipo: artTipo.value.trim(),
        empresa: artEmpresa.value.trim(),
        debutMusica: artDebutMusica.value.trim(),
        debutAno: artDebutAno.value.trim(),
        tiktok: artTiktok.value.trim(),
        imagem: converterDrive(artImagem.value.trim()),
        likes: 0,
        dislikes: 0,
        owner: empresaLogada,
        createdAt: new Date()
    };

    if(!data.nome || !data.tipo || !data.imagem){
        alert("Preencha pelo menos nome, tipo e imagem");
        return;
    }

    db.collection("artist").add(data).then(()=>{
        alert("Artista publicado!");
        carregarArtistas();
    });
}

// ======== CARREGAR ========
function carregarArtistas(){
    db.collection("artist").orderBy("createdAt","desc")
    .onSnapshot(snapshot=>{
        artists.innerHTML="";
        snapshot.forEach(doc=>{
            const a = doc.data();

            artists.innerHTML += `
            <div class="artistCard">
                <img src="${a.imagem}">
                <h3>${a.nome}</h3>
                <p>${a.tipo}</p>
                <p><b>${a.empresa || ""}</b></p>
                <p>Debut: ${a.debutMusica || ""} (${a.debutAno || ""})</p>
                <p>${a.tiktok || ""}</p>
                <p>üëç ${a.likes || 0} | üëé ${a.dislikes || 0}</p>
                <button onclick="like('${doc.id}', ${a.likes || 0})">Like</button>
                <button onclick="dislike('${doc.id}', ${a.dislikes || 0})">Dislike</button>
                ${empresaLogada === a.owner ? `<button onclick="excluir('${doc.id}')">Excluir</button>` : ""}
            </div>
            `;
        });
    });
}

// ======== LIKE/DISLIKE ========
function like(id, valor){
    db.collection("artist").doc(id).update({likes: valor+1});
}

function dislike(id, valor){
    db.collection("artist").doc(id).update({dislikes: valor+1});
}

// ======== EXCLUIR ========
function excluir(id){
    db.collection("artist").doc(id).delete();
}
</script></body>
</html>
