<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>R-net News</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#0f0f0f;
  color:white;
}
header{
  background:#111;
  padding:10px;
  text-align:center;
}
.logo{height:60px; margin-bottom:10px;}
#loginBox, #newsForm{margin:20px; text-align:center;}
input, textarea{padding:8px; margin:5px; width:80%; border-radius:6px; border:none;}
button{padding:8px 15px; margin:5px; border:none; border-radius:6px; background:#ff0055; color:white; cursor:pointer;}
#newsContainer{display:flex; flex-wrap:wrap; justify-content:center; margin:20px;}
.postIt{width:300px; min-height:150px; margin:10px; padding:15px; border-radius:12px; position:relative; color:#111; font-weight:bold; transition:0.3s; box-shadow:0 4px 6px rgba(0,0,0,0.3);}
.postIt:hover{transform:scale(1.03);}
.yellow{background:#fffa65;}
.pink{background:#ff8ad2;}
.green{background:#8aff8a;}
.orange{background:#ffa54a;}
.postImg{width:100%; margin-top:10px; border-radius:8px;}
.editBtn, .deleteBtn{position:absolute; top:5px; cursor:pointer; background:#ff0055; color:white; padding:3px 8px; border-radius:5px; font-size:12px;}
.editBtn{right:35px;}
.deleteBtn{right:5px;}
</style>
</head>
<body>

<header>
  <img src="logo.png" class="logo">
  <h2>R-net News</h2>
</header>

<div id="loginBox">
  <h3>Entre com seu UID ou continue como visitante</h3>
  <input type="text" id="uidInput" placeholder="Seu UID aqui">
  <button onclick="login()">Login</button>
  <button onclick="visitor()">Entrar como visitante</button>
</div>

<div id="newsForm" class="hidden">
  <h3>Postar notícia</h3>
  <input type="text" id="newsTitle" placeholder="Nome da notícia">
  <input type="text" id="newsDate" placeholder="Data (ex: 22/02/2026)">
  <input type="text" id="newsTime" placeholder="Hora (ex: 23:30)">
  <textarea id="newsContent" placeholder="Digite sua notícia aqui"></textarea>
  <input type="text" id="newsImage" placeholder="URL da imagem (opcional)">
  <button onclick="postNews()">Postar notícia</button>
</div>

<div id="newsContainer"></div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyCUFift2BuvD433AYTBVNGCNli2PtBMalo",
  authDomain: "rnetnews-273fc.firebaseapp.com",
  projectId: "rnetnews-273fc",
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

const ADMIN_UID = "jy7EFx66yFYPVEi5XZaSVYcyWrw2"; // Seu UID
let currentUser = null;

// =====================
// LOGIN
// =====================
function login(){
  const uid = document.getElementById("uidInput").value.trim();
  if(uid === ADMIN_UID){
    currentUser = uid;
    document.getElementById("loginBox").classList.add("hidden");
    document.getElementById("newsForm").classList.remove("hidden");
    loadNews();
  } else{
    alert("UID inválido!");
  }
}
function visitor(){
  currentUser = "visitor";
  document.getElementById("loginBox").classList.add("hidden");
  loadNews();
}

// =====================
// POSTAR NOTÍCIA
// =====================
function randomColor(){
  const colors = ["yellow","pink","green","orange"];
  return colors[Math.floor(Math.random()*colors.length)];
}

async function postNews(){
  const title = document.getElementById("newsTitle").value;
  const date = document.getElementById("newsDate").value;
  const time = document.getElementById("newsTime").value;
  const content = document.getElementById("newsContent").value;
  const image = document.getElementById("newsImage").value;

  if(!title || !date || !time || !content) return alert("Preencha todos os campos!");

  await db.collection("news").add({
    title,
    date,
    time,
    content,
    image,
    color: randomColor(),
    createdAt: firebase.firestore.FieldValue.serverTimestamp()
  });

  // Limpar form
  document.getElementById("newsTitle").value="";
  document.getElementById("newsDate").value="";
  document.getElementById("newsTime").value="";
  document.getElementById("newsContent").value="";
  document.getElementById("newsImage").value="";
}

// =====================
// CARREGAR NOTÍCIAS
// =====================
function loadNews(){
  db.collection("news").orderBy("createdAt","desc").onSnapshot(snapshot=>{
    const container = document.getElementById("newsContainer");
    container.innerHTML="";

    snapshot.forEach(doc=>{
      const d = doc.data();
      const post = document.createElement("div");
      post.classList.add("postIt", d.color);
      post.innerHTML = `<h4>${d.title}</h4><small>${d.date} ${d.time}</small><p>${d.content}</p>`;
      if(d.image) post.innerHTML += `<img src="${d.image}" class="postImg">`;

      if(currentUser === ADMIN_UID){
        const editBtn = document.createElement("button");
        editBtn.innerText="Editar";
        editBtn.classList.add("editBtn");
        editBtn.onclick = ()=> editNews(doc.id, d);
        post.appendChild(editBtn);

        const delBtn = document.createElement("button");
        delBtn.innerText="Remover";
        delBtn.classList.add("deleteBtn");
        delBtn.onclick = ()=> removeNews(doc.id);
        post.appendChild(delBtn);
      }

      container.appendChild(post);
    });
  });
}

// =====================
// EDITAR / REMOVER
// =====================
function editNews(id, data){
  const newTitle = prompt("Título:", data.title);
  const newDate = prompt("Data:", data.date);
  const newTime = prompt("Hora:", data.time);
  const newContent = prompt("Conteúdo:", data.content);
  const newImage = prompt("URL da imagem:", data.image||"");

  db.collection("news").doc(id).update({
    title: newTitle,
    date: newDate,
    time: newTime,
    content: newContent,
    image: newImage
  });
}

function removeNews(id){
  if(confirm("Tem certeza que deseja remover esta notícia?")){
    db.collection("news").doc(id).delete();
  }
}
</script>

</body>
</html>
