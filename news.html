<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>R-net News</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#f0f0f0;
}

header{
  background:#111;
  padding:10px;
  text-align:center;
}

.logo{height:55px;}

#newsContainer{
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
  padding:20px;
  gap:15px;
}

/* POST-ITS */
.postIt{
  width:280px;
  min-height:200px;
  padding:15px;
  border-radius:12px;
  box-shadow:0 5px 15px rgba(0,0,0,0.2);
  position:relative;
  font-size:14px;
  color:#111;
  white-space:pre-wrap;
  cursor:pointer;
  transition:0.3s;
}

.postIt:hover{
  transform:scale(1.03);
}

.yellow{background:#fff176;}
.pink{background:#ff8a80;}
.green{background:#b9f6ca;}
.orange{background:#ffd180;}

/* ADMIN PANEL */
#adminPanel{
  max-width:500px;
  margin:20px auto;
  background:#181818;
  color:white;
  padding:15px;
  border-radius:12px;
}

#adminPanel input, #adminPanel textarea{
  width:100%;
  margin-bottom:10px;
  padding:8px;
  border-radius:6px;
  border:none;
}

#adminPanel button{
  background:#ff0055;
  color:white;
  border:none;
  padding:10px 15px;
  border-radius:6px;
  cursor:pointer;
}

.hidden{display:none;}
</style>
</head>
<body>

<header>
  <img src="logo.png" class="logo">
</header>

<!-- ADMIN LOGIN -->
<div id="adminLogin" style="text-align:center; padding:20px;">
  <p>Digite seu UID para acessar o painel:</p>
  <input type="text" id="uidInput" placeholder="Seu UID">
  <button onclick="checkAdmin()">Entrar</button>
</div>

<!-- ADMIN PANEL -->
<div id="adminPanel" class="hidden">
  <h2>Painel de Notícias</h2>
  <input type="text" id="newsTitle" placeholder="Título da notícia">
  <input type="date" id="newsDate">
  <input type="time" id="newsTime">
  <textarea id="newsContent" placeholder="Escreva a notícia aqui..."></textarea>
  <input type="text" id="newsImage" placeholder="URL da imagem (opcional)">
  <button onclick="addNews()">Publicar Notícia</button>
</div>

<!-- MURAL DE NOTÍCIAS -->
<div id="newsContainer"></div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyCUFift2BuvD433AYTBVNGCNli2PtBMalo",
  authDomain: "rnetnews-273fc.firebaseapp.com",
  projectId: "rnetnews-273fc",
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// UID ADMIN
const adminUID = "ITxtdznlxEeXhDoSFcfjYCge6gn1";

// =====================
// CHECK ADMIN
// =====================
function checkAdmin(){
  const uid = document.getElementById("uidInput").value.trim();
  if(uid === adminUID){
    document.getElementById("adminLogin").classList.add("hidden");
    document.getElementById("adminPanel").classList.remove("hidden");
  }else{
    alert("UID incorreto! Apenas o administrador pode postar.");
  }
}

// =====================
// ADICIONAR NOTÍCIA
// =====================
function addNews(){
  const title = document.getElementById("newsTitle").value.trim();
  const date = document.getElementById("newsDate").value;
  const time = document.getElementById("newsTime").value;
  const content = document.getElementById("newsContent").value.trim();
  const image = document.getElementById("newsImage").value.trim();

  if(!title || !date || !time || !content){
    alert("Preencha todos os campos!");
    return;
  }

  db.collection("news").add({
    title, date, time, content, image,
    createdAt: firebase.firestore.FieldValue.serverTimestamp()
  });

  document.getElementById("newsTitle").value = "";
  document.getElementById("newsDate").value = "";
  document.getElementById("newsTime").value = "";
  document.getElementById("newsContent").value = "";
  document.getElementById("newsImage").value = "";
}

// =====================
// REMOVER NOTÍCIAS
// =====================
function removeNews(id){
  if(confirm("Tem certeza que deseja remover esta notícia?")){
    db.collection("news").doc(id).delete();
  }
}

// =====================
// EDITAR NOTÍCIAS
// =====================
function editNews(id, current){
  const newContent = prompt("Edite o conteúdo da notícia:", current.content);
  if(newContent !== null){
    db.collection("news").doc(id).update({content:newContent});
  }
}

// =====================
// CARREGAR NOTÍCIAS
// =====================
function randomColor(){
  const colors = ["yellow","pink","green","orange"];
  return colors[Math.floor(Math.random()*colors.length)];
}

db.collection("news")
.orderBy("createdAt","desc")
.onSnapshot(snapshot=>{
  const container = document.getElementById("newsContainer");
  container.innerHTML="";
  snapshot.forEach(doc=>{
    const d = doc.data();
    const colorClass = randomColor();
    let html = `<div class="postIt ${colorClass}">`;
    if(d.image){
      html += `<img src="${d.image}" style="width:100%; border-radius:8px; margin-bottom:8px;">`;
    }
    html += `<h3>${d.title}</h3>`;
    html += `<p><strong>${d.date} ${d.time}</strong></p>`;
    html += `<p>${d.content}</p>`;
    if(document.getElementById("adminPanel").classList.contains("hidden")===false){
      html += `<button onclick="editNews('${doc.id}', ${JSON.stringify(d)})">Editar</button>`;
      html += `<button onclick="removeNews('${doc.id}')">Remover</button>`;
    }
    html += `</div>`;
    container.innerHTML += html;
  });
});
</script>

</body>
</html>
