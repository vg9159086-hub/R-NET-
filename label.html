<!DOCTYPE html><html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>R-Net - Label</title><style>
body{
    margin:0;
    font-family: Arial;
    background:#f5f5f5;
}

header{
    background:#ff4da6;
    color:white;
    padding:15px;
    text-align:center;
    font-size:22px;
    font-weight:bold;
}

.container{
    padding:15px;
}

.card{
    background:white;
    padding:15px;
    margin-bottom:20px;
    border-radius:12px;
    box-shadow:0 2px 6px rgba(0,0,0,0.1);
}

h3{
    margin-top:0;
    color:#ff4da6;
}

input{
    width:100%;
    padding:8px;
    margin-top:6px;
    margin-bottom:10px;
    border-radius:6px;
    border:1px solid #ccc;
}

button{
    padding:10px;
    border:none;
    border-radius:8px;
    cursor:pointer;
    margin-top:5px;
}

.btn-main{
    background:#ff4da6;
    color:white;
    width:100%;
}

.artist{
    border-top:1px solid #eee;
    margin-top:15px;
    padding-top:15px;
}

.artist img{
    width:100%;
    height:180px;
    object-fit:contain;
    background:black;
    border-radius:8px;
}
</style></head>
<body><header>Label Panel</header><div class="container"><div class="card">
    <h3 id="empresaInfo"></h3>
</div>

<!-- GRUPO -->
<div class="card">
    <h3>Cadastrar Grupo</h3>
    <input type="text" id="grupoNome" placeholder="Nome do grupo">
    <input type="text" id="grupoConceito" placeholder="Conceito">
    <input type="date" id="grupoDebut">
    <input type="file" id="grupoFoto" accept="image/*">
    <button class="btn-main" onclick="salvarGrupo()">Salvar Grupo</button>
</div>

<!-- SOLO -->
<div class="card">
    <h3>Cadastrar Solista</h3>
    <input type="text" id="soloNome" placeholder="Nome do solista">
    <input type="text" id="soloConceito" placeholder="Conceito">
    <input type="date" id="soloDebut">
    <input type="file" id="soloFoto" accept="image/*">
    <button class="btn-main" onclick="salvarSolo()">Salvar Solista</button>
</div>

<!-- LISTA -->
<div class="card">
    <h3>Artistas da Empresa</h3>
    <div id="listaArtistas"></div>
</div>

</div><script>

// =====================
// EMPRESA ATUAL
// =====================
let empresa = JSON.parse(localStorage.getItem("empresaAtual"));

if(empresa){
    document.getElementById("empresaInfo").innerText =
    empresa.nomeEmpresa + " | CEO: " + empresa.ceo;
}

// =====================
// BANCO LOCAL
// =====================
let artistas = JSON.parse(localStorage.getItem("artistas")) || [];
let mvs = JSON.parse(localStorage.getItem("mvs")) || [];

// =====================
// UTILIDADES
// =====================
function lerImagem(input, callback){
    if(input.files && input.files[0]){
        let reader = new FileReader();
        reader.onload = e => callback(e.target.result);
        reader.readAsDataURL(input.files[0]);
    }else{
        callback("");
    }
}

function semanaAtual(){
    let now = new Date();
    let onejan = new Date(now.getFullYear(),0,1);
    return Math.ceil((((now - onejan)/86400000)+onejan.getDay()+1)/7);
}

function linkYoutubeValido(link){
    return link.includes("youtube.com") || link.includes("youtu.be");
}

// =====================
// SALVAR GRUPO
// =====================
function salvarGrupo(){

    if(!confirm("Tem certeza que deseja cadastrar este grupo?")) return;

    lerImagem(document.getElementById("grupoFoto"), function(img){

        let grupo = {
            id: Date.now(),
            tipo: "Grupo",
            empresa: empresa.nomeEmpresa,
            nome: document.getElementById("grupoNome").value,
            conceito: document.getElementById("grupoConceito").value,
            debut: document.getElementById("grupoDebut").value,
            foto: img
        };

        artistas.push(grupo);
        localStorage.setItem("artistas", JSON.stringify(artistas));
        renderArtistas();
    });
}

// =====================
// SALVAR SOLO
// =====================
function salvarSolo(){

    if(!confirm("Tem certeza que deseja cadastrar este solista?")) return;

    lerImagem(document.getElementById("soloFoto"), function(img){

        let solo = {
            id: Date.now(),
            tipo: "Solista",
            empresa: empresa.nomeEmpresa,
            nome: document.getElementById("soloNome").value,
            conceito: document.getElementById("soloConceito").value,
            debut: document.getElementById("soloDebut").value,
            foto: img
        };

        artistas.push(solo);
        localStorage.setItem("artistas", JSON.stringify(artistas));
        renderArtistas();
    });
}

// =====================
// ADICIONAR MV
// =====================
function adicionarMV(artistaId){

    let link = prompt("Cole o link do YouTube:");

    if(!link) return;

    if(!linkYoutubeValido(link)){
        alert("Só é permitido link do YouTube!");
        return;
    }

    let artista = artistas.find(a => a.id == artistaId);
    let semana = new Date().getFullYear() + "-" + semanaAtual();

    let novoMV = {
        id: Date.now(),
        artistaId: artistaId,
        grupo: artista.nome,
        empresa: artista.empresa,
        link: link,
        semana: semana,
        likes: 0,
        dislikes: 0,
        comentarios: []
    };

    mvs.push(novoMV);
    localStorage.setItem("mvs", JSON.stringify(mvs));

    alert("MV publicado! Já está no MV Zone.");
}

// =====================
// RENDER
// =====================
function renderArtistas(){

    let div = document.getElementById("listaArtistas");
    div.innerHTML = "";

    artistas
    .filter(a => a.empresa == empresa.nomeEmpresa)
    .forEach(a => {

        div.innerHTML += `
        <div class="artist">
            <h4>${a.nome} (${a.tipo})</h4>
            ${a.foto ? `<img src="${a.foto}">` : ""}
            <p>Conceito: ${a.conceito}</p>
            <p>Debut: ${a.debut}</p>
            <button class="btn-main" onclick="adicionarMV(${a.id})">
                Adicionar MV
            </button>
        </div>
        `;
    });
}

renderArtistas();

</script></body>
</html>
