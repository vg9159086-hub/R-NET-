<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Label - Painel da Empresa</title>
<style>
body{
    margin:0;
    font-family:Arial;
    background:linear-gradient(180deg,#111,#1b0033);
    color:white;
}

.topo{
    background:#6a00ff;
    padding:15px;
    text-align:center;
    font-size:20px;
    font-weight:bold;
}

.container{
    padding:15px;
}

.card{
    background:#1e1e1e;
    padding:15px;
    border-radius:12px;
    margin-bottom:15px;
}

input, select{
    width:100%;
    padding:8px;
    margin-top:8px;
    border-radius:6px;
    border:none;
}

button{
    margin-top:10px;
    padding:8px 12px;
    border:none;
    border-radius:6px;
    cursor:pointer;
    font-weight:bold;
}

.btn-add{ background:#00c853; color:white; }
.btn-del{ background:#ff1744; color:white; }
.btn-mv{ background:#2979ff; color:white; }

.grupo{
    background:#262626;
    padding:10px;
    border-radius:10px;
    margin-top:10px;
}

.grupo img{
    width:100%;
    height:180px;
    object-fit:cover;
    border-radius:8px;
}

.mv-list{
    margin-top:8px;
    font-size:13px;
}

.small-btn{
    font-size:11px;
    padding:5px;
}
</style>
</head>
<body>

<div class="topo">Painel da Label</div>

<div class="container">

<div class="card">
<h3>Cadastrar Grupo / Solista</h3>
<input type="text" id="nomeArtista" placeholder="Nome">
<select id="tipoArtista">
<option value="grupo">Grupo</option>
<option value="solo">Solista</option>
</select>
<input type="file" id="fotoArtista" accept="image/*">
<button class="btn-add" onclick="adicionarArtista()">Cadastrar</button>
</div>

<div id="listaArtistas"></div>

</div>

<script>

// üîí Verifica√ß√£o se √© empresa
if(localStorage.getItem("tipoConta") !== "empresa"){
    alert("Apenas empresas podem acessar essa √°rea!");
    window.location.href="home.html";
}

// Banco local
let artistas = JSON.parse(localStorage.getItem("artistas")) || [];
let mvZone = JSON.parse(localStorage.getItem("mvZone")) || [];

function salvar(){
    localStorage.setItem("artistas", JSON.stringify(artistas));
    localStorage.setItem("mvZone", JSON.stringify(mvZone));
}

function adicionarArtista(){
    let nome = document.getElementById("nomeArtista").value;
    let tipo = document.getElementById("tipoArtista").value;
    let fotoInput = document.getElementById("fotoArtista");

    if(!nome || !fotoInput.files[0]){
        alert("Preencha tudo!");
        return;
    }

    let limiteGrupo = artistas.filter(a=>a.tipo==="grupo").length;
    let limiteSolo = artistas.filter(a=>a.tipo==="solo").length;

    if(tipo==="grupo" && limiteGrupo>=15){
        alert("Limite de 15 grupos atingido!");
        return;
    }

    if(tipo==="solo" && limiteSolo>=10){
        alert("Limite de 10 solistas atingido!");
        return;
    }

    let reader = new FileReader();
    reader.onload = function(e){
        artistas.push({
            id: Date.now(),
            nome,
            tipo,
            foto:e.target.result,
            mvs:[],
            ultimaSemana:null
        });

        salvar();
        render();
    }
    reader.readAsDataURL(fotoInput.files[0]);
}

function adicionarMV(id){
    let artista = artistas.find(a=>a.id===id);
    let link = prompt("Cole o link do YouTube:");

    if(!link) return;

    if(!link.includes("youtube.com") && !link.includes("youtu.be")){
        alert("Apenas links do YouTube s√£o permitidos!");
        return;
    }

    let semanaAtual = new Date().getWeek();

    if(artista.ultimaSemana === semanaAtual){
        alert("Esse artista j√° enviou MV essa semana!");
        return;
    }

    artista.mvs.push(link);
    artista.ultimaSemana = semanaAtual;

    mvZone.push({
        nome:artista.nome,
        foto:artista.foto,
        link,
        likes:0
    });

    salvar();
    render();
    alert("MV enviado para o MV Zone!");
}

function deletarArtista(id){
    if(!confirm("Tem certeza que deseja deletar?")) return;
    artistas = artistas.filter(a=>a.id!==id);
    salvar();
    render();
}

function deletarMV(artistaId, index){
    if(!confirm("Tem certeza que deseja deletar o MV?")) return;

    let artista = artistas.find(a=>a.id===artistaId);
    artista.mvs.splice(index,1);

    salvar();
    render();
}

function render(){
    let div = document.getElementById("listaArtistas");
    div.innerHTML="";

    artistas.forEach(a=>{
        div.innerHTML+=`
        <div class="grupo">
            <img src="${a.foto}">
            <h4>${a.nome} (${a.tipo})</h4>
            <button class="btn-mv small-btn" onclick="adicionarMV(${a.id})">Adicionar MV</button>
            <button class="btn-del small-btn" onclick="deletarArtista(${a.id})">Deletar</button>
            <div class="mv-list">
                ${a.mvs.map((mv,i)=>`
                    <div>
                        ${mv}
                        <button class="btn-del small-btn" onclick="deletarMV(${a.id},${i})">X</button>
                    </div>
                `).join("")}
            </div>
        </div>
        `;
    });
}

// Fun√ß√£o semana
Date.prototype.getWeek = function(){
    let onejan = new Date(this.getFullYear(),0,1);
    return Math.ceil((((this - onejan) / 86400000) + onejan.getDay()+1)/7);
};

render();

</script>

</body>
</html>
