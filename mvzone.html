<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>RNET MV Zone</title>
<style>
body{
    margin:0;
    font-family:Arial;
    background:#000;
    color:#fff;
    padding:10px;
}
header{
    background:#111;
    color:#ff2d8b;
    text-align:center;
    font-size:22px;
    font-weight:bold;
    padding:10px;
}
.container{
    padding:10px;
}
.card{
    background:#111;
    padding:10px;
    margin-bottom:15px;
    border-radius:10px;
}
button{
    background:#ff2d8b;
    border:none;
    color:#fff;
    padding:5px 10px;
    margin:2px;
    border-radius:5px;
    cursor:pointer;
}
input{
    width:90%;
    padding:5px;
    margin:5px 0;
    border-radius:5px;
    border:none;
}
.hidden{display:none;}
</style>
</head>
<body>

<header>RNET</header>

<div class="container">

<!-- LOGIN -->
<div id="login" class="card">
<h2>Entrar como:</h2>
<button onclick="entrarEmpresa()">Empresa</button>
<button onclick="entrarVisitante()">Visitante</button>
</div>

<!-- LABEL (Adicionar Artista) -->
<div id="label" class="hidden card">
<h2>Adicionar Artista (Empresa)</h2>
<input id="artistaNome" placeholder="Nome do Artista">
<input id="empresaNome" placeholder="Nome da Empresa">
<input id="mvLink" placeholder="Link do MV (YouTube)">
<button onclick="adicionarArtista()">Adicionar</button>

<h3>Artistas Cadastrados</h3>
<div id="listaArtistas"></div>
</div>

<!-- MV ZONE -->
<div id="mvzone" class="hidden card">
<h2>MV Zone / Charts</h2>
<div id="ranking"></div>
</div>

</div>

<script>
// ============================
// GERAR ID √öNICO DE USU√ÅRIO
// ============================
let userID = localStorage.getItem("rnet_userID");
if(!userID){
    userID = "user_"+Math.random().toString(36).substr(2,9);
    localStorage.setItem("rnet_userID", userID);
}

// ============================
// LOGIN
// ============================
let isEmpresa = false;

function entrarEmpresa(){
    isEmpresa = true;
    document.getElementById("login").classList.add("hidden");
    document.getElementById("label").classList.remove("hidden");
    document.getElementById("mvzone").classList.remove("hidden");
}

function entrarVisitante(){
    isEmpresa = false;
    document.getElementById("login").classList.add("hidden");
    document.getElementById("mvzone").classList.remove("hidden");
}

// ============================
// BANCO DE ARTISTAS
// ============================
let artistas = JSON.parse(localStorage.getItem("rnet_mvs")) || [];

// ============================
// FUN√á√ÉO ADICIONAR ARTISTA
// ============================
function adicionarArtista(){
    if(!isEmpresa){ alert("Somente empresas podem adicionar artistas!"); return; }

    let nome = document.getElementById("artistaNome").value;
    let empresa = document.getElementById("empresaNome").value;
    let mv = document.getElementById("mvLink").value;

    if(!nome || !empresa || !mv){
        alert("Preencha todos os campos!");
        return;
    }

    // Limite de 15 grupos / 10 solos
    let countEmpresa = artistas.filter(a=>a.empresa==empresa).length;
    if(countEmpresa>=15){ alert("Limite de artistas para esta empresa atingido!"); return; }

    artistas.push({
        id:userID+"_"+Date.now(),
        nome:nome,
        empresa:empresa,
        url:mv,
        pontos:0,
        likes:[],
        dislikes:[],
        comentarios:[],
        data: new Date().getTime()
    });

    salvar();
    document.getElementById("artistaNome").value="";
    document.getElementById("empresaNome").value="";
    document.getElementById("mvLink").value="";
}

// ============================
// SALVAR & RENDER
// ============================
function salvar(){
    localStorage.setItem("rnet_mvs", JSON.stringify(artistas));
    renderLabel();
    renderRanking();
}

// ============================
// RENDER LABEL
// ============================
function renderLabel(){
    let lista = document.getElementById("listaArtistas");
    lista.innerHTML="";
    artistas.forEach((a,i)=>{
        if(a.empresa && isEmpresa){
            lista.innerHTML+=`
            <div class="card">
            <h3>${a.nome} (${a.empresa})</h3>
            <p>MV: <a href="${a.url}" target="_blank">${a.url}</a></p>
            <button onclick="removerArtista(${i})">Remover MV</button>
            </div>`;
        }
    });
}

function removerArtista(i){
    if(artistas[i].empresa != document.getElementById("empresaNome").value && !isEmpresa) return;
    artistas.splice(i,1);
    salvar();
}

// ============================
// RENDER RANKING / MV ZONE
// ============================
function renderRanking(){
    const now = new Date().getTime();
    // Remove MVs com mais de 1 m√™s
    artistas = artistas.filter(a => now - a.data < 30*24*60*60*1000);

    let ranking = document.getElementById("ranking");
    ranking.innerHTML="";

    // Ordenar por pontos
    let ordenado = [...artistas].sort((a,b)=>b.pontos-a.pontos);

    ordenado.forEach((a,i)=>{
        let userLiked = a.likes.includes(userID);
        let userDisliked = a.dislikes.includes(userID);
        ranking.innerHTML+=`
        <div class="card">
        <h3>#${i+1} ${a.nome} (${a.empresa}) - ${a.pontos} pts</h3>
        <iframe width="100%" height="200" src="${a.url.replace("watch?v=","embed/")}" frameborder="0" allowfullscreen></iframe>
        <div>
        <button onclick="darLike('${a.id}')">${userLiked?'Remover Like':'üëç Like'}</button>
        <button onclick="darDislike('${a.id}')">${userDisliked?'Remover Deslike':'üëé Deslike'}</button>
        </div>
        <div>
        <input id="nomeC_${a.id}" placeholder="Seu nome">
        <input id="comC_${a.id}" placeholder="Coment√°rio">
        <button onclick="comentar('${a.id}')">Comentar</button>
        </div>
        <div>${a.comentarios.map(c=>`<p><b>${c.user}:</b> ${c.texto} <button onclick="removerComentario('${a.id}','${c.id}')">X</button></p>`).join("")}</div>
        </div>
        `;
    });
}

// ============================
// LIKE / DISLIKE
// ============================
function darLike(id){
    let a = artistas.find(x=>x.id==id);
    if(a.likes.includes(userID)){
        a.likes = a.likes.filter(x=>x!=userID);
        a.pontos -=5;
    } else {
        if(a.dislikes.includes(userID)){
            a.dislikes = a.dislikes.filter(x=>x!=userID);
            a.pontos +=5;
        }
        a.likes.push(userID);
        a.pontos +=5;
    }
    salvar();
}

function darDislike(id){
    let a = artistas.find(x=>x.id==id);
    if(a.dislikes.includes(userID)){
        a.dislikes = a.dislikes.filter(x=>x!=userID);
        a.pontos +=5;
    } else {
        if(a.likes.includes(userID)){
            a.likes = a.likes.filter(x=>x!=userID);
            a.pontos -=5;
        }
        a.dislikes.push(userID);
        a.pontos -=5;
    }
    salvar();
}

// ============================
// COMENT√ÅRIOS
// ============================
function comentar(id){
    let artista = artistas.find(x=>x.id==id);
    let user = document.getElementById("nomeC_"+id).value;
    let texto = document.getElementById("comC_"+id).value;
    if(!user || !texto) return;

    artista.comentarios.push({
        id:userID+"_"+Date.now(),
        user:user,
        texto:texto
    });
    salvar();
}

function removerComentario(artistaID, comID){
    let artista = artistas.find(x=>x.id==artistaID);
    artista.comentarios = artista.comentarios.filter(c=>c.id != comID || c.id.split("_")[0]!=userID);
    salvar();
}

// ============================
// RESET SEMANAL AUTOM√ÅTICO
// ============================
function resetSemanal(){
    artistas.forEach(a=>a.pontos=0);
    salvar();
}

// Chamar reset semanal (aqui exemplo, toda vez que abre pode simular)
setInterval(resetSemanal, 7*24*60*60*1000); // 7 dias

// ============================
renderLabel();
renderRanking();
</script>

</body>
</html>
